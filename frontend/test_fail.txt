
> landingpage@1.0.0 test
> jest src/__tests__/TravelHighlightsPage.test.tsx --ci --no-cache

[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
  console.error
    Warning: An update to TravelHighlightsPage inside a test was not wrapped in act(...).

    When testing, code that causes React state updates should be wrapped into act(...):

    act(() => {
      /* fire events that update state */
    });
    /* assert on the output */

    This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
        at TravelHighlightsPage (/Users/lukaszremkowicz/Projects/landingpage/frontend/src/components/TravelHighlightsPage.tsx:14:47)
        at routeContext (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/hooks.tsx:658:26)
        at children (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/components.tsx:512:3)
        at basenameProp (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/components.tsx:421:13)
        at basename (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/components.tsx:225:3)

      63 |         fetchEnabledFeatures(),
      64 |       ]);
    > 65 |       set({
         |       ^
      66 |         profile: profileData,
      67 |         backgroundUrl: bgUrl,
      68 |         features: featuresData,

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at forceStoreRerender (node_modules/react-dom/cjs/react-dom.development.js:16158:5)
      at handleStoreChange (node_modules/react-dom/cjs/react-dom.development.js:16134:7)
      at node_modules/zustand/vanilla.js:11:39
          at Set.forEach (<anonymous>)
      at setState (node_modules/zustand/vanilla.js:11:17)
      at set (src/store/useStore.ts:65:7)
      at Generator.call (src/store/useStore.ts:2:1)
      at Generator._invoke [as next] (src/store/useStore.ts:2:1)
      at asyncGeneratorStep (src/store/useStore.ts:2:1)
      at asyncGeneratorStep (src/store/useStore.ts:2:1)

  console.error
    Warning: An update to TravelHighlightsPage inside a test was not wrapped in act(...).

    When testing, code that causes React state updates should be wrapped into act(...):

    act(() => {
      /* fire events that update state */
    });
    /* assert on the output */

    This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
        at TravelHighlightsPage (/Users/lukaszremkowicz/Projects/landingpage/frontend/src/components/TravelHighlightsPage.tsx:14:47)
        at routeContext (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/hooks.tsx:658:26)
        at children (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/components.tsx:512:3)
        at basenameProp (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/components.tsx:421:13)
        at basename (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/components.tsx:225:3)

      78 |       console.error("Store initial load failure:", e);
      79 |     } finally {
    > 80 |       set({ isInitialLoading: false });
         |       ^
      81 |     }
      82 |   },
      83 |

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at forceStoreRerender (node_modules/react-dom/cjs/react-dom.development.js:16158:5)
      at handleStoreChange (node_modules/react-dom/cjs/react-dom.development.js:16134:7)
      at node_modules/zustand/vanilla.js:11:39
          at Set.forEach (<anonymous>)
      at setState (node_modules/zustand/vanilla.js:11:17)
      at set (src/store/useStore.ts:80:7)
      at Generator.call (src/store/useStore.ts:2:1)
      at Generator._invoke [as next] (src/store/useStore.ts:2:1)
      at asyncGeneratorStep (src/store/useStore.ts:2:1)
      at asyncGeneratorStep (src/store/useStore.ts:2:1)

  console.error
    Error: Uncaught [TypeError: Cannot read properties of undefined (reading 'then')]
        at reportException (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
        at innerInvokeEventListeners (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
        at invokeEventListeners (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
        at HTMLUnknownElementImpl._dispatch (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
        at HTMLUnknownElementImpl.dispatchEvent (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
        at HTMLUnknownElement.dispatchEvent (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
        at Object.invokeGuardedCallbackDev (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
        at invokeGuardedCallback (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
        at reportUncaughtErrorInDEV (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
        at captureCommitPhaseError (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:27165:5)
        at commitPassiveMountEffects_complete (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:24932:9)
        at commitPassiveMountEffects_begin (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
        at commitPassiveMountEffects (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
        at flushPassiveEffectsImpl (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
        at flushPassiveEffects (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
        at commitRootImpl (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:26974:5)
        at commitRoot (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:26721:5)
        at performSyncWorkOnRoot (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:26156:3)
        at flushSyncCallbacks (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:12042:22)
        at flushActQueue (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react/cjs/react.development.js:2667:24)
        at recursivelyFlushAsyncActWork (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react/cjs/react.development.js:2633:9)
        at /Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react/cjs/react.development.js:2545:15 {
      detail: TypeError: Cannot read properties of undefined (reading 'then')
          at /Users/lukaszremkowicz/Projects/landingpage/frontend/src/components/common/ImageModal.tsx:34:30
          at commitHookEffectListMount (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
          at commitPassiveMountOnFiber (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
          at commitPassiveMountEffects_complete (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
          at commitPassiveMountEffects_begin (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
          at commitPassiveMountEffects (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
          at flushPassiveEffectsImpl (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
          at flushPassiveEffects (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
          at commitRootImpl (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:26974:5)
          at commitRoot (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:26721:5)
          at performSyncWorkOnRoot (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:26156:3)
          at flushSyncCallbacks (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-dom/cjs/react-dom.development.js:12042:22)
          at flushActQueue (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react/cjs/react.development.js:2667:24)
          at recursivelyFlushAsyncActWork (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react/cjs/react.development.js:2633:9)
          at /Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react/cjs/react.development.js:2545:15,
      type: 'unhandled exception'
    }

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at reportUncaughtErrorInDEV (node_modules/react-dom/cjs/react-dom.development.js:22877:5)
      at captureCommitPhaseError (node_modules/react-dom/cjs/react-dom.development.js:27165:5)
      at commitPassiveMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24932:9)
      at commitPassiveMountEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24917:7)
      at commitPassiveMountEffects (node_modules/react-dom/cjs/react-dom.development.js:24905:3)
      at flushPassiveEffectsImpl (node_modules/react-dom/cjs/react-dom.development.js:27078:3)
      at flushPassiveEffects (node_modules/react-dom/cjs/react-dom.development.js:27023:14)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26974:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at performSyncWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:26156:3)
      at flushSyncCallbacks (node_modules/react-dom/cjs/react-dom.development.js:12042:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at recursivelyFlushAsyncActWork (node_modules/react/cjs/react.development.js:2633:9)
      at node_modules/react/cjs/react.development.js:2545:15

  console.error
    The above error occurred in the <ImageModal> component:

        at image (/Users/lukaszremkowicz/Projects/landingpage/frontend/src/components/common/ImageModal.tsx:15:50)
        at div
        at TravelHighlightsPage (/Users/lukaszremkowicz/Projects/landingpage/frontend/src/components/TravelHighlightsPage.tsx:14:47)
        at routeContext (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/hooks.tsx:658:26)
        at children (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/components.tsx:512:3)
        at basenameProp (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/components.tsx:421:13)
        at basename (/Users/lukaszremkowicz/Projects/landingpage/frontend/node_modules/react-router/lib/components.tsx:225:3)

    Consider adding an error boundary to your tree to customize error handling behavior.
    Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at performSyncWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:26156:3)
      at flushSyncCallbacks (node_modules/react-dom/cjs/react-dom.development.js:12042:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at recursivelyFlushAsyncActWork (node_modules/react/cjs/react.development.js:2633:9)
      at node_modules/react/cjs/react.development.js:2545:15

FAIL src/__tests__/TravelHighlightsPage.test.tsx
  TravelHighlightsPage
    ✓ renders loading state initially (37 ms)
    ✓ renders content after successful fetch (14 ms)
    ✓ handles API error gracefully (5 ms)
    ✕ opens modal on image click (18 ms)

  ● TravelHighlightsPage › opens modal on image click

    TypeError: Cannot read properties of undefined (reading 'then')

      32 |
      33 |     setLoading(true);
    > 34 |     fetchAstroImage(image.pk)
         |                              ^
      35 |       .then((data: AstroImage) => {
      36 |         setDetailedImage(data);
      37 |         setDescription(data.description || "No description available.");

      at src/components/common/ImageModal.tsx:34:30
      at commitHookEffectListMount (node_modules/react-dom/cjs/react-dom.development.js:23189:26)
      at commitPassiveMountOnFiber (node_modules/react-dom/cjs/react-dom.development.js:24970:11)
      at commitPassiveMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24930:9)
      at commitPassiveMountEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24917:7)
      at commitPassiveMountEffects (node_modules/react-dom/cjs/react-dom.development.js:24905:3)
      at flushPassiveEffectsImpl (node_modules/react-dom/cjs/react-dom.development.js:27078:3)
      at flushPassiveEffects (node_modules/react-dom/cjs/react-dom.development.js:27023:14)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26974:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at performSyncWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:26156:3)
      at flushSyncCallbacks (node_modules/react-dom/cjs/react-dom.development.js:12042:22)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at recursivelyFlushAsyncActWork (node_modules/react/cjs/react.development.js:2633:9)
      at node_modules/react/cjs/react.development.js:2545:15

Test Suites: 1 failed, 1 total
Tests:       1 failed, 3 passed, 4 total
Snapshots:   0 total
Time:        1.056 s
Ran all test suites matching /src\/__tests__\/TravelHighlightsPage.test.tsx/i.
